# Listeners contains the set of listeners to register. Each listener has an
# endpoint ID, address to forward connections to, whether to log each request
# and a timeout to forward requests to the upstreams.
listeners:
  - endpoint_id: my-endpoint
    # Address of the upstream, which may be a port, host and port, or URL.
    addr: localhost:8000
    # Protocol to listen on. Supports "http" and "tcp", defaults to "http".
    protocol: http
    # Whether to log all incoming HTTP requests as 'info'.
    access_log: true
    # Timeout forwarding incoming HTTP requests to the upstream.
    timeout: 15s

connect:
  # The Piko server URL to connect to. Note this must be configured to use the
  # Piko server 'upstream' port.
  url: http://d2a6ivdsubz6nc.cloudfront.net

  # Token is a token to authenticate with the Piko server.
  token: ""

  # Timeout attempting to connect to the Piko server on boot. Note if the agent
  # is disconnected after the initial connection succeeds it will keep trying to
  # reconnect.
  timeout: 30s

  tls:
    # A path to a certificate PEM file containing root certificate authorities to
    # validate the TLS connection to the Piko server.
    #
    # Defaults to using the host root CAs.
    root_cas: ""

    # Configures the agent to accept any certificate presented by the server and any
    # host name in that certificate.
    insecure_skip_verify: false

server:           
  # Whether to enable the agent metrics server.
  #
  # Disabled by default.
  enabled: false

  # The host/port to bind the server to.
  #
  # If the host is unspecified it defaults to all listeners, such as
  # '--server.bind-addr :5000' will listen on '0.0.0.0:5000'.
  bind_addr: ":5000"

log:
    # Minimum log level to output.
    #
    # The available levels are 'debug', 'info', 'warn' and 'error'.
    level: info

    # Each log has a 'subsystem' field where the log occured.
    #
    # '--log.subsystems' enables all log levels for those given subsystems. This
    # can be useful to debug a particular subsystem without having to enable all
    # debug logs.
    #
    # Such as you can enable 'gossip' logs with '--log.subsystems gossip'.
    subsystems: []

# Maximum duration after a shutdown signal is received (SIGTERM or
# SIGINT) to gracefully shutdown each listener.
grace_period: 1m0s